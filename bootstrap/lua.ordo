let emit_ffi f =
    match f {
        :ffi_file_read_lines filename -> sprintf "file_lines('%s')" filename
      | :ffi_file_read filename -> sprintf "file_read('%s')" filename
    }
in
let rec emit_expr o_var expr =
    match expr {
        :expr_ffi f -> emit_ffi f
      | :expr_int i -> sprintf "%d" i
    }
in
let emit_prelude =
    let prelude = file.read "std.lua"